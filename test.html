<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>Простой тест</title>
    <script src="https://telegram.org/js/telegram-web-app.js"></script>
</head>
<body>
    <h1>Простой тест</h1>
    <div id="log"></div>
    <button onclick="sendSimpleData()">Простая отправка</button>
    
    <script>
        function log(msg) {
            document.getElementById('log').innerHTML += msg + '<br>';
            console.log(msg);
        }
        
        function sendSimpleData() {
            log('Отправляю простые данные...');
            
            const data = {test: "hello", games: ["CS2"]};
            
            if (window.Telegram && window.Telegram.WebApp) {
                try {
                    window.Telegram.WebApp.sendData(JSON.stringify(data));
                    log('Данные отправлены через sendData');
                    
                    setTimeout(() => {
                        window.Telegram.WebApp.close();
                    }, 1000);
                } catch (e) {
                    log('Ошибка: ' + e.message);
                }
            } else {
                log('Telegram WebApp не найден');
            }
        }
        
        // Инициализация
        if (window.Telegram && window.Telegram.WebApp) {
            log('Telegram найден');
            window.Telegram.WebApp.ready();
            window.Telegram.WebApp.expand();
            
            // Главная кнопка
            window.Telegram.WebApp.MainButton.text = "Отправить";
            window.Telegram.WebApp.MainButton.show();
            window.Telegram.WebApp.MainButton.onClick(sendSimpleData);
            
        } else {
            log('Telegram НЕ найден');
        }
    </script>
</body>
</html>
